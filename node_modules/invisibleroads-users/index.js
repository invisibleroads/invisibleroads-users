x = IR.users;
var user_id = x.user_id;
var csrf_token = x.csrf_token;
if (user_id) {
  // Send CSRF token automatically for AJAX requests
  $.ajaxSetup({
    beforeSend: function(xhr, settings) {
      if (/^(POST|PATCH|DELETE|PUT)$/.test(settings.type) && !this.crossDomain) {
        xhr.setRequestHeader('X-CSRF-Token', csrf_token);
      }
    }
  });
  // Send CSRF token automatically for form requests
  $('form').submit(function() {
    var $form = $(this), url_parser = document.createElement('a');
    // Get source_host
    var source_host = location.host;
    // Get target_host
    url_parser.href = $form.prop('action');
    var target_host = url_parser.host;
    // Do not append csrf_token for cross-domain requests
    if (target_host != source_host) return;
    // Check whether it already exists
    if ($form.find('[name=csrf_token]').length) return;
    // Append csrf_token
    $form.append($('<input>', {
      name: 'csrf_token',
      value: csrf_token,
      type: 'hidden'
    }));
  });
}
$('.enter').click(function() {
  var $enter_user_form = $('#enter-user-form');
  if (user_id) {
    location.href = $enter_user_form.find('[name=target_url]').val();
  } else {
    $enter_user_form.submit();
  }
  return false;
});
